<div class="header-container">
  <h2>Gestión de Padres/Apoderados</h2>
  <button mat-flat-button color="primary" (click)="openAddDialog()">
    <mat-icon>add</mat-icon>
    Nuevo Padre
  </button>
</div>

<div class="dashboard-filter">
  <mat-form-field appearance="outline" class="w-full">
    <mat-label>Filtrar Padres...</mat-label>
    <input matInput (keyup)="applyFilter($event)" placeholder="Buscar por nombre, documento, email...">
  </mat-form-field>
</div>

<div class="nk-card p-0 overflow-hidden">
  <table mat-table [dataSource]="dsPadres" class="nk-table">

        <ng-container matColumnDef="nombre">
      <th mat-header-cell *matHeaderCellDef> Nombre </th>
      <td mat-cell *matCellDef="let p"> {{p.nombre}} {{p.apellido}} </td>
    </ng-container>

        <ng-container matColumnDef="tipoDocumento">
      <th mat-header-cell *matHeaderCellDef> Tipo Doc. </th>
      <td mat-cell *matCellDef="let p"> {{p.tipoDocumento}} </td>
    </ng-container>

        <ng-container matColumnDef="dni">
      <th mat-header-cell *matHeaderCellDef> N° Documento </th>
      <td mat-cell *matCellDef="let p"> {{p.dni}} </td>
    </ng-container>

        <ng-container matColumnDef="email">
      <th mat-header-cell *matHeaderCellDef> Email </th>
      <td mat-cell *matCellDef="let p"> {{p.email}} </td>
    </ng-container>

        <ng-container matColumnDef="telefono">
      <th mat-header-cell *matHeaderCellDef> Teléfono </th>
      <td mat-cell *matCellDef="let p"> {{p.telefono}} </td>
    </ng-container>

        <ng-container matColumnDef="tipoParentesco">
      <th mat-header-cell *matHeaderCellDef> Parentesco </th>
      <td mat-cell *matCellDef="let p"> {{p.tipoParentesco}} </td>
    </ng-container>

        <ng-container matColumnDef="claveVisible">
      <th mat-header-cell *matHeaderCellDef> Contraseña </th>
      <td mat-cell *matCellDef="let p" class="password-cell">
        <span class="password-text">{{p.claveVisible || 'No asignada'}}</span>
        <button mat-icon-button (click)="copiarClave(p.claveVisible)" matTooltip="Copiar contraseña" *ngIf="p.claveVisible">
          <mat-icon>content_copy</mat-icon>
        </button>
      </td>
    </ng-container>

        <ng-container matColumnDef="estado">
      <th mat-header-cell *matHeaderCellDef> Estado </th>
      <td mat-cell *matCellDef="let p" class="estado-cell">
        <span class="estado-chip activo" *ngIf="p.usuarioActivo !== false">
          <mat-icon>check_circle</mat-icon> Activo
        </span>
        <span class="estado-chip inactivo" *ngIf="p.usuarioActivo === false">
          <mat-icon>block</mat-icon> Inactivo
        </span>
      </td>
    </ng-container>

        <ng-container matColumnDef="actions">
      <th mat-header-cell *matHeaderCellDef> Opciones </th>
      <td mat-cell *matCellDef="let p" class="flex gap-2">
        <button mat-icon-button color="primary" (click)="openEditDialog(p)" matTooltip="Editar">
          <mat-icon>edit</mat-icon>
        </button>
        <button mat-icon-button 
                [color]="p.usuarioActivo !== false ? 'warn' : 'primary'" 
                (click)="toggleEstadoPadre(p)" 
                [matTooltip]="p.usuarioActivo !== false ? 'Desactivar acceso' : 'Reactivar acceso'">
          <mat-icon>{{p.usuarioActivo !== false ? 'block' : 'check_circle'}}</mat-icon>
        </button>
      </td>
    </ng-container>

    <tr mat-header-row *matHeaderRowDef="displayedColumns"></tr>
    <tr mat-row *matRowDef="let row; columns: displayedColumns;"></tr>
  </table>
</div>